# UnrealIRCd 3.2.8.1 Backdoor Command Execution

## Description :

UnrealIRCd 3.2.8.1, as distributed on certain mirror sites from November 2009 through June 2010, contains an externally introduced modification (Trojan Horse) in the `DEBUG3_DOLOG_SYSTEM` macro, which allows remote attackers to execute arbitrary commands.

Seems like the UnrealIRCd team themselves discovered the backdoor.

Metasploit module is also available for this vulnerability. It's written by:

* hdm <x@hdm.io>

## Digging the hole

The official security advisory (http://www.unrealircd.com/txt/unrealsecadvisory.20100612.txt) for getting detailed information is not available at the moment, throws **ERR_CONNECTION_TIMED_OUT**

To get it anyway, we can utilize the **Wayback Machine**

Read the local copy of advisory : [unrealsecadvisory.20100612.txt](unrealsecadvisory.20100612.txt)

```
This is very embarrassing...

We found out that the Unreal3.2.8.1.tar.gz file on our mirrors has been
replaced quite a while ago with a version with a backdoor (trojan) in it.
This backdoor allows a person to execute ANY command with the privileges of
the user running the ircd. The backdoor can be executed regardless of any user
restrictions (so even if you have passworded server or hub that doesn't allow
any users in).

It appears the replacement of the .tar.gz occurred in November 2009 (at least on some mirrors). It seems nobody noticed it until now.
```

Let's get our hands on it. Again, the advisory provides the md5sum we should look for.

```
One is to check if the Unreal3.2.8.1.tar.gz you have is good or bad by running 'md5sum Unreal3.2.8.1.tar.gz' on it.

Backdoored version (BAD) is: 752e46f2d873c1679fa99de3f52a274d
```

